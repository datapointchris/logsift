# Common error patterns for universal detection
# These patterns match common error indicators across different tools
# IMPORTANT: These patterns must match the FULL log message including level indicators
# The parser does NOT strip level prefixes - all detection happens here

# Universal error level detection - matches any format
[[patterns]]
name = "level_error_any_format"
regex = "(?i)^\\s*\\[?\\s*(ERROR|FATAL)\\s*\\]?\\s*[:\\-\\|\\s]"
severity = "error"
description = "Error level indicator in any format (ERROR:, [ERROR], ERROR -, etc.)"
tags = ["level", "error"]

[[patterns]]
name = "level_warning_any_format"
regex = "(?i)^\\s*\\[?\\s*(WARNING|WARN)\\s*\\]?\\s*[:\\-\\|\\s]"
severity = "warning"
description = "Warning level indicator in any format (WARNING:, [WARN], WARNING -, etc.)"
tags = ["level", "warning"]

# Generic error keywords (fallback when no level indicator present)
[[patterns]]
name = "generic_error"
regex = "(?i)(error|failed|failure|exception):\\s*(.+)"
severity = "error"
description = "Generic error pattern"
tags = ["generic", "error"]

[[patterns]]
name = "generic_warning"
regex = "(?i)(warning|warn):\\s*(.+)"
severity = "warning"
description = "Generic warning pattern"
tags = ["generic", "warning"]

[[patterns]]
name = "file_not_found"
regex = "(?i)(no such file or directory|file not found):\\s*(.+)"
severity = "error"
description = "File not found error"
tags = ["filesystem", "error"]

[[patterns]]
name = "permission_denied"
regex = "(?i)(permission denied|access denied):\\s*(.+)"
severity = "error"
description = "Permission/access denied error"
tags = ["filesystem", "permissions", "error"]

# Test failure patterns (universal - work across test frameworks)

[[patterns]]
name = "test_failed_cross_mark"
regex = "âœ—.*FAILED"
severity = "error"
description = "Test failed (indicated by cross mark)"
tags = ["test", "failure", "error"]
suggestion = "Review test output and fix the failing test"

[[patterns]]
name = "test_suite_failures"
regex = "FAILURES:\\s*\\d+\\s+passed,\\s*\\d+\\s+failed"
severity = "error"
description = "Test suite completed with failures"
tags = ["test", "suite", "failure", "error"]
suggestion = "Review failed tests and fix issues before proceeding"
